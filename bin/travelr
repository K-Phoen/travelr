#!/usr/bin/env php
<?php

require __DIR__.'/../vendor/autoload.php';

use Travelr\Cli\Application;
use Travelr\Cli\Command;
use Travelr\Cli\Container;

use Symfony\Component\Console\Output\OutputInterface;
use Pimple\Psr11\Container as Psr11Container;

$dotenv = new Dotenv\Dotenv(__DIR__.'/../');
$dotenv->load();

$app = new Application();
$app->useContainer(new Psr11Container(new Container()));

$app
    ->command('albums:list', [Command\ListAlbums::class, 'run'])
    ->descriptions('List available albums.');

$app->command('albums:compile', [Command\CompileAlbums::class, 'run']);
$app->command('html:compile', [Command\CompileHtml::class, 'run']);
$app->command('build', function (OutputInterface $output) use ($app) {
    $app->runCommand('albums:compile', $output);
    $app->runCommand('html:compile', $output);
});

$app->run();
