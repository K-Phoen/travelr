#!/usr/bin/env bash

set -e

echo -e '\e[32m→ Building…\e[0m'
make release

echo -e '\e[32m→ Saving the changes on the gh-pages branch…\e[0m'
git branch -D gh-pages draft || true
git checkout -b draft
git add -f web/
git commit -am "Published by `whoami`"
git subtree split --prefix web -b gh-pages

echo -e '\e[32m→ Pushing…\e[0m'
git push --force origin gh-pages:gh-pages
